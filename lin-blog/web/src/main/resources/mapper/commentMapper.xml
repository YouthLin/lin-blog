<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.youthlin.blog.dao.CommentDao">
    <resultMap id="optionMap" type="com.youthlin.blog.model.po.Comment">
        <id property="commentId" column="comment_ID"/>
        <result property="commentPostId" column="comment_post_ID"/>
        <result property="commentAuthor" column="comment_author"/>
        <result property="commentAuthorEmail" column="comment_author_email"/>
        <result property="commentAuthorUrl" column="comment_author_url"/>
        <result property="commentAuthorIp" column="comment_author_IP"/>
        <result property="commentDate" column="comment_date"/>
        <result property="commentDateUtc" column="comment_date_utc"/>
        <result property="commentContent" column="comment_content"/>
        <result property="commentStatus" column="comment_status"/>
        <result property="commentAgent" column="comment_agent"/>
        <result property="commentType" column="comment_type"/>
        <result property="commentParent" column="comment_parent"/>
        <result property="userId" column="user_id"/>
    </resultMap>

    <sql id="all">
        comment_ID, comment_post_ID, comment_author, comment_author_email, comment_author_url, comment_author_IP,
        comment_date, comment_date_utc, comment_content, comment_status, comment_agent, comment_type, comment_parent, user_id
    </sql>

    <insert id="save" useGeneratedKeys="true" parameterType="com.youthlin.blog.model.po.Comment"
            keyProperty="commentId">
        INSERT INTO comments
        (comment_post_ID, comment_author, comment_author_email, comment_author_url,
         comment_author_IP, comment_date, comment_date_utc,
         comment_content, comment_status, comment_agent, comment_type, comment_parent, user_id)
        VALUES
            (#{commentPostId}, #{commentAuthor}, #{commentAuthorEmail}, #{commentAuthorUrl},
                               #{commentAuthorIp}, #{commentDate}, #{commentDateUtc}, #{commentContent},
                               #{commentStatus}, #{commentAgent}, #{commentType}, #{commentParent}, #{userId})
    </insert>

    <select id="findByPostId" resultMap="optionMap">
        SELECT
        <include refid="all"/>
        FROM comments
        WHERE comment_post_ID=#{postId}
        ORDER BY comment_ID
    </select>

</mapper>
